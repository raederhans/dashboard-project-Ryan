-- points
SELECT the_geom, dispatch_date_time, text_general_code, ucr_general, dc_dist, location_block
FROM incidents_part1_part2
WHERE dispatch_date_time >= '2015-01-01'
  AND dispatch_date_time >= '2023-01-01'
  AND dispatch_date_time < '2023-07-01'
  AND text_general_code IN ('THEFT')
  AND the_geom && ST_MakeEnvelope(-8396000, 4854000, -8330000, 4890000, 3857)
  AND dc_dist = '14'

-- monthly(district)
SELECT date_trunc('month', dispatch_date_time) AS m, COUNT(*) AS n
FROM incidents_part1_part2
WHERE dispatch_date_time >= '2015-01-01'
  AND dispatch_date_time >= '2023-01-01'
  AND dispatch_date_time < '2023-07-01'
  AND text_general_code IN ('THEFT')
  AND dc_dist = '14'
GROUP BY 1 ORDER BY 1

-- 7x24(district)
SELECT EXTRACT(DOW  FROM dispatch_date_time AT TIME ZONE 'America/New_York') AS dow,
       EXTRACT(HOUR FROM dispatch_date_time AT TIME ZONE 'America/New_York') AS hr,
       COUNT(*) AS n
FROM incidents_part1_part2
WHERE dispatch_date_time >= '2015-01-01'
  AND dispatch_date_time >= '2023-01-01'
  AND dispatch_date_time < '2023-07-01'
  AND text_general_code IN ('THEFT')
  AND dc_dist = '14'
GROUP BY 1,2 ORDER BY 1,2
